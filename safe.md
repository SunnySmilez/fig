互联网项目安全
=======================

编码安全
-----------------------
安全编码定义了一套可以集成到开发生命周期中的通用软件安全编码规范。采用这些规范将减少最为常见的安全漏洞，也可以作为在代码review时安全**checklist**名单

#### 输入验证
认为所有客户端传输的数据皆不可信，验证所有来自客户端的数据,包括:
* 所有请求参数
* URL
* HTTP 头信息(比如:cookie 名字和数据值)

验证正确的数据类型，数据范围，数据长度，数据格式

尽可能采用**白名单**和**正则表达**形式，验证所有的输入

丢弃任何没有通过输入验证的数据，不允许在程序里直接使用$_GET$_POST等获取外部数据

**不建议**只使用转义，使用转义必须有其他控制手段，转义函数可以参考htmlentities，htmlspecialchars

如果任何潜在的危险字符必须被作为输入，请确保您执行了额外的控制，比如:输入转义、输出编码、特定的安全 API、以及在应用程序中使用的原因。部分常见的危险字符包括:< > " ' % ( ) & + \ \' \" 。

#### 访问控制
除了那些特定设为“公开”的内容以外,对所有的网页和资源要求身份验证。

对资源获取的时候都需要判断是不是该用户能操作和获取的。避免越权和全面遍历。

对操作和浏览尽量小的权限，提升权限的时候需要进一步验证。

当设计外网访问API接口时应注意：
* 防止请求内容篡改和伪造
* 防止请求内容被重放攻击
* 确保请求是由应用方所发起
* 尽可能使用HTTPS传输
如果只有以上几点可以使用phplib里封装的security/api组件

当设计JS或者客户端请求接口时应注意：
* 校验请求refer，不仅有域限制，而且要严格限制请求发起地址
* 关键数据变更可以使用验证token，封装在phplib里封装的security/token组件

在关键位置要做防止机器破解控制，比如：注册登录
* 使用频率控制器，限制尝试次数
* 使用验证码区别人机

#### 数据保护
对隐私和主要机密信息，在存储设备上应该做加密处理，用来验证的信息使用散列函数求值存储（比如密码），用来获取的信息使用对称加密算法AES处理（比如手机号）

为防范对随机数据的猜测攻击,应当使用加密模块中已验证的随机数生成器生成所有的随机数、随机文件名、随机 GUID 和随机字符串

不要在客户端上以明文形式或其他非加密安全模式保存密码、连接字符串或其他敏感信息。 这包括嵌入在不安全的形式中:MS viewstate、Adobe flash 或者已编译的代码。

对数据采用一定的措施降低泄露后威胁程度，比如（给身份证图片添加无法擦除水印，避免用于其他用途）

包含敏感信息的数据传输的采用TLS

当链接到外部站点时,过滤来自 HTTP referer 中包含敏感信息的参数（比如sessionid）

限制只有授权的用户才能访问文件或其他资源，比如（用户自身上传的非公开的图片）


系统安全
------------------------
#### centos操作系统安全
#### nginx webserver安全
#### php安全设置



网络安全
------------------------
#### DNS劫持和污染
DNS劫持 就是通过劫持了 DNS 服务器，通过某些手段取得某域名的解析记录控制权，进而修改此域名的解析结果，导致对该域名的访问由原 IP 地址转入到修改后的指定IP，其结果就是对特定的网址不能访问或访问的是假网址，从而实现窃取资料或者破坏原有正常服务的目的。DNS劫持通过篡改DNS服务器上的数据返回给用户一个错误的查询结果来实现的。

DNS污染 是一种让一般用户由于得到虚假目标主机 IP 而不能与其通信的方法，是一种DNS 缓存投毒攻击（DNS cache poisoning）。其工作方式是：由于通常的 DNS 查询没有任何认证机制，而且 DNS 查询通常基于的 UDP 是无连接不可靠的协议，因此 DNS 的查询非常容易被篡改，通过对 UDP 端口 53 上的 DNS 查询进行入侵检测，一经发现与关键词相匹配的请求则立即伪装成目标域名的解析服务器（NS，Name Server）给查询者返回虚假结果。DNS污染 症状：目前一些在天朝被禁止访问的网站基本都是通过 DNS污染 来实现的，例如 YouTube、Facebook 等网站。

#### 链路监听劫持
链路劫持其实就是指网络链路上侦听、伪造TCP包，达到控制目标网络链路的行为。最常见的就是某些设备实现的对非法站点的访问拦截，以及一些地区运营商的网页植入广告行为。

目前发现的TCP链路劫持攻击一般有两种形式：中断访问型（分为单向发包和双向发包）和替换页面型。
 
中断访问型常见于阻止用户访问某些网站，如某些设备禁止用户访问某些站点、某地运营商的禁止ADSL多终端上网功能。其原理就是伪造服务端给用户发RST包阻止TCP连接的建立（单向发包）。某些设备做得比较狠，在冒充服务端给用户发RST包的同时也冒充用户给服务端发RST包（双向发包）。
 
替换页面型常见于运营商植入广告，也有篡改正常网页进行SEO、骗流量的。笔者见过最恶劣的莫过于钓鱼，如2011年出现过的Gmail钓鱼事件以及一些不能告诉你的钓鱼事件。原理也简单，就是在一个HTTP请求后伪造服务端的HTTP响应给客户端。
#### DDOS
